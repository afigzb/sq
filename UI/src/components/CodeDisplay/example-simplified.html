<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeDisplayç¤ºä¾‹ - å¯ç¼–è¾‘ä»£ç å±•ç¤º</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .controls {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .control-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
        }

        .control-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-item label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9rem;
        }

        select, button, input[type="checkbox"] {
            padding: 10px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        input[type="checkbox"] {
            width: auto;
            padding: 0;
            margin: 5px;
        }

        select:focus, button:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .input-section {
            padding: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #495057;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .output-section {
            padding: 30px;
            background: #f8f9fa;
        }

        .demo-section {
            padding: 30px;
            border-top: 1px solid #e9ecef;
        }

        .demo-codes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .demo-item {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .demo-title {
            background: #495057;
            color: white;
            padding: 10px 15px;
            font-weight: 600;
            font-size: 14px;
        }

        .status-bar {
            background: #e9ecef;
            padding: 10px 30px;
            font-size: 14px;
            color: #495057;
            border-top: 1px solid #dee2e6;
        }

        .status-item {
            margin-right: 20px;
        }

        .status-item strong {
            color: #667eea;
        }

        @media (max-width: 768px) {
            .control-group {
                flex-direction: column;
                align-items: stretch;
            }

            .demo-codes {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <h1>ğŸ¨ CodeDisplay</h1>
            <p>å¯ç¼–è¾‘çš„ä»£ç å±•ç¤ºç»„ä»¶ - æ”¯æŒå®æ—¶ç¼–è¾‘å’Œè¯­æ³•é«˜äº®</p>
        </div>

        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="controls">
            <div class="control-group">
                <div class="control-item">
                    <label for="languageSelect">ç¼–ç¨‹è¯­è¨€ï¼š</label>
                    <select id="languageSelect">
                        <option value="javascript">JavaScript</option>
                        <option value="python">Python</option>
                        <option value="java">Java</option>
                        <option value="css">CSS</option>
                        <option value="html">HTML</option>
                        <option value="json">JSON</option>
                        <option value="sql">SQL</option>
                        <option value="bash">Bash</option>
                    </select>
                </div>
                
                <div class="control-item">
                    <label for="themeSelect">ä¸»é¢˜ï¼š</label>
                    <select id="themeSelect">
                        <option value="prism">Default</option>
                        <option value="prism-dark">Dark</option>
                        <option value="prism-funky">Funky</option>
                        <option value="prism-okaidia">Okaidia</option>
                        <option value="prism-tomorrow">Tomorrow</option>
                        <option value="prism-coy">Coy</option>
                        <option value="prism-solarizedlight">Solarized Light</option>
                        <option value="prism-twilight">Twilight</option>
                    </select>
                </div>

                <div class="control-item">
                    <label>
                        <input type="checkbox" id="showLineNumbers" checked> æ˜¾ç¤ºè¡Œå·
                    </label>
                </div>

                <div class="control-item">
                    <label>
                        <input type="checkbox" id="enableEditing"> å¯ç”¨ç¼–è¾‘æ¨¡å¼
                    </label>
                </div>
                
                <div class="control-item">
                    <label>&nbsp;</label>
                    <button onclick="generateCode()">ç”Ÿæˆä»£ç å±•ç¤º</button>
                </div>
                
                <div class="control-item">
                    <label>&nbsp;</label>
                    <button onclick="toggleEditing()">åˆ‡æ¢ç¼–è¾‘æ¨¡å¼</button>
                </div>
                
                <div class="control-item">
                    <label>&nbsp;</label>
                    <button onclick="getCodeContent()">è·å–ä»£ç å†…å®¹</button>
                </div>
                
                <div class="control-item">
                    <label>&nbsp;</label>
                    <button onclick="clearAll()">æ¸…ç©ºæ‰€æœ‰</button>
                </div>
            </div>
        </div>

        <!-- è¾“å…¥åŒºåŸŸ -->
        <div class="input-section">
            <div class="input-group">
                <label for="codeInput">è¯·è¾“å…¥ä½ çš„ä»£ç ï¼š</label>
                <textarea id="codeInput" placeholder="åœ¨è¿™é‡Œç²˜è´´æˆ–è¾“å…¥ä½ çš„ä»£ç ...">// å¯ç¼–è¾‘çš„ä»£ç ç¤ºä¾‹
function createTodoApp() {
    const todos = [];
    
    function addTodo(text) {
        const todo = {
            id: Date.now(),
            text: text,
            completed: false,
            createdAt: new Date()
        };
        todos.push(todo);
        renderTodos();
    }
    
    function toggleTodo(id) {
        const todo = todos.find(t => t.id === id);
        if (todo) {
            todo.completed = !todo.completed;
            renderTodos();
        }
    }
    
    function deleteTodo(id) {
        const index = todos.findIndex(t => t.id === id);
        if (index > -1) {
            todos.splice(index, 1);
            renderTodos();
        }
    }
    
    function renderTodos() {
        const container = document.getElementById('todo-list');
        container.innerHTML = '';
        
        todos.forEach(todo => {
            const item = document.createElement('div');
            item.className = `todo-item ${todo.completed ? 'completed' : ''}`;
            
            const toggleBtn = document.createElement('button');
            toggleBtn.textContent = todo.completed ? 'å–æ¶ˆå®Œæˆ' : 'å®Œæˆ';
            toggleBtn.onclick = () => toggleTodo(todo.id);
            
            const deleteBtn = document.createElement('button');
            deleteBtn.textContent = 'åˆ é™¤';
            deleteBtn.onclick = () => deleteTodo(todo.id);
            
            item.innerHTML = `<span>${todo.text}</span>`;
            item.appendChild(toggleBtn);
            item.appendChild(deleteBtn);
            
            container.appendChild(item);
        });
    }
    
    return { addTodo, toggleTodo, deleteTodo };
}</textarea>
            </div>
        </div>

        <!-- è¾“å‡ºåŒºåŸŸ -->
        <div class="output-section">
            <h3 style="margin-bottom: 20px; color: #495057;">ä»£ç å±•ç¤ºæ•ˆæœï¼š</h3>
            <div id="codeOutput"></div>
        </div>

        <!-- çŠ¶æ€æ  -->
        <div class="status-bar">
            <span class="status-item"><strong>çŠ¶æ€:</strong> <span id="editStatus">åªè¯»æ¨¡å¼</span></span>
            <span class="status-item"><strong>è¡Œæ•°:</strong> <span id="lineCount">0</span></span>
            <span class="status-item"><strong>å­—ç¬¦æ•°:</strong> <span id="charCount">0</span></span>
            <span class="status-item"><strong>è¯­è¨€:</strong> <span id="currentLanguage">javascript</span></span>
        </div>

        <!-- ç¤ºä¾‹ä»£ç  -->
        <div class="demo-section">
            <h3 style="margin-bottom: 20px; color: #495057;">é¢„è®¾ç¤ºä¾‹ï¼ˆå¯ç¼–è¾‘ï¼‰ï¼š</h3>
            <div class="demo-codes">
                <div class="demo-item">
                    <div class="demo-title">JavaScript ç¤ºä¾‹</div>
                    <div id="demo-js"></div>
                </div>

                <div class="demo-item">
                    <div class="demo-title">Python ç¤ºä¾‹</div>
                    <div id="demo-python"></div>
                </div>

                <div class="demo-item">
                    <div class="demo-title">CSS ç¤ºä¾‹</div>
                    <div id="demo-css"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥é‡æ„åçš„ CodeDisplay ç»„ä»¶ -->
    <script src="CodeDisplay.js"></script>
    
    <script>
        // å…¨å±€ CodeDisplay å®ä¾‹
        let currentDisplay = null;

        // ç”Ÿæˆä»£ç å±•ç¤º
        async function generateCode() {
            const codeInput = document.getElementById('codeInput').value.trim();
            const language = document.getElementById('languageSelect').value;
            const output = document.getElementById('codeOutput');

            if (!codeInput) {
                alert('è¯·å…ˆè¾“å…¥ä»£ç ï¼');
                return;
            }

            // è·å–é€‰é¡¹
            const options = {
                theme: document.getElementById('themeSelect').value,
                showLineNumbers: document.getElementById('showLineNumbers').checked,
                editable: document.getElementById('enableEditing').checked,
                onChange: function(code, lang) {
                    console.log('ä»£ç å·²æ›´æ”¹:', code);
                    updateStatus(code, lang);
                    // åŒæ­¥æ›´æ–°è¾“å…¥æ¡†
                    document.getElementById('codeInput').value = code;
                }
            };

            // å¦‚æœå·²æœ‰å®ä¾‹ä¸”åªæ˜¯æ›´æ–°ä»£ç æˆ–è¯­è¨€ï¼Œåˆ™å¤ç”¨å®ä¾‹
            if (currentDisplay) {
                // æ›´æ–°é€‰é¡¹
                currentDisplay.options = { ...currentDisplay.options, ...options };
                
                // æ›´æ–°ä»£ç å’Œè¯­è¨€
                currentDisplay.setCode(codeInput, language);
                
                // æ›´æ–°å…¶ä»–è®¾ç½®
                currentDisplay.setEditable(options.editable);
                currentDisplay.toggleLineNumbers(options.showLineNumbers);
                currentDisplay.changeTheme(options.theme);
            } else {
                // åˆ›å»ºæ–°çš„ CodeDisplay å®ä¾‹
                currentDisplay = new CodeDisplay(output, options);
                await currentDisplay.render(codeInput, language);
            }
            
            // æ›´æ–°çŠ¶æ€
            updateStatus(codeInput, language);
        }

        // åˆ‡æ¢ç¼–è¾‘æ¨¡å¼
        function toggleEditing() {
            if (!currentDisplay) {
                alert('è¯·å…ˆç”Ÿæˆä»£ç å±•ç¤ºï¼');
                return;
            }
            
            const checkbox = document.getElementById('enableEditing');
            const newEditableState = !checkbox.checked;
            checkbox.checked = newEditableState;
            
            currentDisplay.setEditable(newEditableState);
            updateEditStatus(newEditableState);
        }

        // è·å–ä»£ç å†…å®¹
        function getCodeContent() {
            if (!currentDisplay) {
                alert('è¯·å…ˆç”Ÿæˆä»£ç å±•ç¤ºï¼');
                return;
            }
            
            const code = currentDisplay.getCode();
            const language = currentDisplay.getLanguage();
            
            const preview = code.length > 200 ? code.substring(0, 200) + '...' : code;
            alert('å½“å‰ä»£ç å†…å®¹:\nè¯­è¨€: ' + language + '\nè¡Œæ•°: ' + code.split('\n').length + '\nå­—ç¬¦æ•°: ' + code.length + '\n\n' + preview);
        }

        // åˆ‡æ¢ä¸»é¢˜
        function changeTheme() {
            if (currentDisplay) {
                const theme = document.getElementById('themeSelect').value;
                currentDisplay.changeTheme(theme);
            }
        }

        // åˆ‡æ¢è¡Œå·
        function toggleLineNumbers() {
            if (currentDisplay) {
                const showLineNumbers = document.getElementById('showLineNumbers').checked;
                currentDisplay.toggleLineNumbers(showLineNumbers);
            }
        }

        // æ›´æ–°çŠ¶æ€æ 
        function updateStatus(code, language) {
            document.getElementById('lineCount').textContent = code.split('\n').length;
            document.getElementById('charCount').textContent = code.length;
            document.getElementById('currentLanguage').textContent = language;
        }

        // æ›´æ–°ç¼–è¾‘çŠ¶æ€
        function updateEditStatus(isEditable) {
            document.getElementById('editStatus').textContent = isEditable ? 'ç¼–è¾‘æ¨¡å¼' : 'åªè¯»æ¨¡å¼';
        }

        // æ¸…ç©ºæ‰€æœ‰
        function clearAll() {
            document.getElementById('codeInput').value = '';
            document.getElementById('codeOutput').innerHTML = '';
            currentDisplay = null;
            updateStatus('', 'javascript');
            updateEditStatus(false);
        }

        // äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('languageSelect').addEventListener('change', changeLanguage);
        document.getElementById('themeSelect').addEventListener('change', changeTheme);
        document.getElementById('showLineNumbers').addEventListener('change', toggleLineNumbers);
        document.getElementById('enableEditing').addEventListener('change', function() {
            if (currentDisplay) {
                const isEditable = document.getElementById('enableEditing').checked;
                currentDisplay.setEditable(isEditable);
                updateEditStatus(isEditable);
            }
        });
        
        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                generateCode();
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–ç¤ºä¾‹
        document.addEventListener('DOMContentLoaded', function() {
            // ç­‰å¾…ä¸€æ®µæ—¶é—´ç¡®ä¿ Prism åŠ è½½å®Œæˆ
            setTimeout(async function() {
                await initDemoExamples();
                await generateCode(); // è‡ªåŠ¨ç”Ÿæˆé»˜è®¤ç¤ºä¾‹
            }, 1000);
        });

        // åˆå§‹åŒ–ç¤ºä¾‹ä»£ç 
        async function initDemoExamples() {
            // JavaScript ç¤ºä¾‹
            const jsCode = '// React Hook ç¤ºä¾‹\nfunction Counter() {\n    const [count, setCount] = useState(0);\n    \n    return (\n        <div>\n            <p>Count: {count}</p>\n            <button onClick={() => setCount(count + 1)}>\n                Increment\n            </button>\n        </div>\n    );\n}';

            // Python ç¤ºä¾‹
            const pythonCode = '# æ•°æ®å¤„ç†ç¤ºä¾‹\nimport pandas as pd\n\nclass DataProcessor:\n    def __init__(self):\n        self.data = None\n        \n    def load_data(self, data):\n        self.data = pd.DataFrame(data)\n        print(f"æ•°æ®åŠ è½½å®Œæˆ: {self.data.shape}")\n        \n    def analyze(self):\n        return self.data.describe()';

            // CSS ç¤ºä¾‹
            const cssCode = '/* ç°ä»£å¡ç‰‡æ ·å¼ */\n.card {\n    background: white;\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n    transition: all 0.3s ease;\n}\n\n.card:hover {\n    transform: translateY(-8px);\n    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);\n}';

            // åˆ›å»ºå¯ç¼–è¾‘çš„ç¤ºä¾‹
            const demoOptions = {
                theme: 'prism-okaidia',
                showLineNumbers: true,
                editable: true,
                maxHeight: '400px',
                onChange: function(code, language) {
                    console.log(language + ' ä»£ç å·²æ›´æ”¹:', code.substring(0, 50) + '...');
                }
            };

            // ä½¿ç”¨å¼‚æ­¥æ–¹å¼åˆ›å»ºç¤ºä¾‹
            await CodeDisplay.create('#demo-js', jsCode, 'javascript', demoOptions);
            await CodeDisplay.create('#demo-python', pythonCode, 'python', demoOptions);
            await CodeDisplay.create('#demo-css', cssCode, 'css', demoOptions);
        }

        // åˆ‡æ¢è¯­è¨€
        function changeLanguage() {
            if (currentDisplay) {
                const language = document.getElementById('languageSelect').value;
                currentDisplay.setLanguage(language);
                updateStatus(currentDisplay.getCode(), language);
            }
        }
    </script>
</body>
</html> 
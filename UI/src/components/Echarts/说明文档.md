# EChartFactory2 å›¾è¡¨å·¥å‚ è¯´æ˜æ–‡æ¡£

## ğŸ“Š é¡¹ç›®ç®€ä»‹

EChartFactory2 æ˜¯ä¸€ä¸ªåŸºäº ECharts çš„ç®€åŒ–ç‰ˆå›¾è¡¨å·¥å‚ï¼Œæ—¨åœ¨æä¾›æ›´ç®€å•ã€æ›´çµæ´»çš„å›¾è¡¨åˆ›å»ºå’Œç®¡ç†æ–¹æ¡ˆã€‚ç›¸æ¯” v1 ç‰ˆæœ¬ï¼Œå°†æ‰€æœ‰é€»è¾‘å†…èšåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå‡å°‘æ–‡ä»¶ä¾èµ–ï¼Œæé«˜æ˜“ç”¨æ€§ã€‚

### ğŸ¯ è®¾è®¡ç†å¿µ

- **ç®€åŒ–**ï¼šå°†å¤æ‚çš„å›¾è¡¨é…ç½®ç®€åŒ–ä¸ºç›´è§‚çš„APIè°ƒç”¨
- **çµæ´»**ï¼šæ”¯æŒå¤šç§å›¾è¡¨ç±»å‹ã€ä¸»é¢˜åˆ‡æ¢ã€è‡ªå®šä¹‰é…ç½®
- **æ˜“æ‰©å±•**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ–°å¢å›¾è¡¨ç±»å‹å’Œä¸»é¢˜éƒ½å¾ˆæ–¹ä¾¿
- **æ˜“ç»´æŠ¤**ï¼šä»£ç ç»“æ„æ¸…æ™°ï¼Œæ³¨é‡Šè¯¦ç»†

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“ˆ æ”¯æŒçš„å›¾è¡¨ç±»å‹

| å›¾è¡¨ç±»å‹ | è¯´æ˜ | ç‰¹è‰²åŠŸèƒ½ |
|---------|------|---------|
| `bar` | æŸ±çŠ¶å›¾ | æ”¯æŒå †å ã€æ¨ªå‘æ˜¾ç¤º |
| `line` | æŠ˜çº¿å›¾ | æ”¯æŒé¢ç§¯å¡«å……ã€å¹³æ»‘æ›²çº¿ |
| `pie` | é¥¼å›¾ | æ”¯æŒç«ç‘°å›¾ã€ç¯å½¢å›¾ |
| `radar` | é›·è¾¾å›¾ | å¤šç»´åº¦æ•°æ®å¯¹æ¯” |
| `scatter` | æ•£ç‚¹å›¾ | ä¸¤å˜é‡å…³ç³»å±•ç¤º |
| `polarBar` | æåæ ‡æŸ±çŠ¶å›¾ | ç¯å½¢æŸ±çŠ¶å›¾æ•ˆæœ |
| `polarLine` | æåæ ‡æŠ˜çº¿å›¾ | å‘¨æœŸæ€§æ•°æ®å±•ç¤º |

### ğŸ¨ å†…ç½®ä¸»é¢˜

- **default** - é»˜è®¤ä¸»é¢˜ï¼Œç»å…¸è“è‰²ç³»
- **futuristic** - ç§‘æŠ€ä¸»é¢˜ï¼Œæ·±è‰²èƒŒæ™¯+ç‚«å½©è‰²å½©
- **minimal** - æç®€ä¸»é¢˜ï¼Œé»‘ç™½ç°é…è‰²
- **cleanDark** - å¹²å‡€æ·±è‰²ä¸»é¢˜ï¼Œé€‚åˆæš—è‰²ç•Œé¢

### ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

- âœ… è‡ªåŠ¨å“åº”å¼é€‚é…
- âœ… ä¸»é¢˜åŠ¨æ€åˆ‡æ¢
- âœ… å›¾è¡¨ç±»å‹åŠ¨æ€åˆ‡æ¢
- âœ… é¢„è®¾é…ç½®ç³»ç»Ÿ
- âœ… æ‰¹é‡å›¾è¡¨åˆ›å»º
- âœ… è‡ªå®šä¹‰æ ·å¼æ”¯æŒ
- âœ… å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºç¡€ç”¨æ³•

```javascript
import { createChart } from './EchartFactory2.js';

// åˆ›å»ºå®¹å™¨
const container = document.getElementById('chart-container');

// åˆ›å»ºæŸ±çŠ¶å›¾
const chart = createChart(container, 'bar', 'default');

// å‡†å¤‡æ•°æ®
const data = {
  xAxis: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”'],
  series: {
    name: 'é”€é‡',
    data: [120, 200, 150, 80, 70],
    color: '#5470c6'
  }
};

// æ›´æ–°å›¾è¡¨
chart.update(data);
```

### é«˜çº§ç”¨æ³•

```javascript
import { EChartFactory2 } from './EchartFactory2.js';

// åˆ›å»ºå·¥å‚å®ä¾‹
const factory = new EChartFactory2(container, 'line', 'futuristic');

// åˆå§‹åŒ–å¹¶é…ç½®
factory.init()
  .setPreset('dashboard')  // è®¾ç½®é¢„è®¾
  .update(data, {
    areaStyle: true,        // é¢ç§¯å¡«å……
    stack: 'total'          // å †å æ˜¾ç¤º
  });

// åŠ¨æ€åˆ‡æ¢ä¸»é¢˜
factory.switchTheme('minimal');

// åŠ¨æ€åˆ‡æ¢å›¾è¡¨ç±»å‹
factory.switchType('bar');
```

## ğŸ“š API æ–‡æ¡£

### EChartFactory2 ç±»

#### æ„é€ å‡½æ•°

```javascript
new EChartFactory2(container, chartType, theme)
```

| å‚æ•° | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|--------|
| container | HTMLElement | å›¾è¡¨å®¹å™¨DOMå…ƒç´  | - |
| chartType | string | å›¾è¡¨ç±»å‹ | 'bar' |
| theme | string/Object | ä¸»é¢˜åç§°æˆ–ä¸»é¢˜å¯¹è±¡ | 'default' |

#### ä¸»è¦æ–¹æ³•

##### `init()`
åˆå§‹åŒ–å›¾è¡¨å®ä¾‹
- **è¿”å›**: `EChartFactory2` - æ”¯æŒé“¾å¼è°ƒç”¨
- **è¯´æ˜**: åˆ›å»ºEChartså®ä¾‹å¹¶è®¾ç½®è‡ªé€‚åº”ç›‘å¬

##### `update(data, config)`
æ›´æ–°å›¾è¡¨æ•°æ®å’Œé…ç½®
- **å‚æ•°**:
  - `data` (Object): å›¾è¡¨æ•°æ®å¯¹è±¡
  - `config` (Object): è‡ªå®šä¹‰é…ç½®å¯¹è±¡
- **è¿”å›**: `EChartFactory2` - æ”¯æŒé“¾å¼è°ƒç”¨

##### `switchTheme(themeName)`
åˆ‡æ¢å›¾è¡¨ä¸»é¢˜
- **å‚æ•°**: `themeName` (string/Object) - ä¸»é¢˜åç§°æˆ–ä¸»é¢˜å¯¹è±¡
- **è¿”å›**: `EChartFactory2` - æ”¯æŒé“¾å¼è°ƒç”¨

##### `switchType(chartType)`
åˆ‡æ¢å›¾è¡¨ç±»å‹
- **å‚æ•°**: `chartType` (string) - æ–°çš„å›¾è¡¨ç±»å‹
- **è¿”å›**: `EChartFactory2` - æ”¯æŒé“¾å¼è°ƒç”¨

##### `setPreset(presetName)`
è®¾ç½®é¢„è®¾é…ç½®
- **å‚æ•°**: `presetName` (string) - é¢„è®¾åç§°
- **è¿”å›**: `EChartFactory2` - æ”¯æŒé“¾å¼è°ƒç”¨

##### `getInstance()`
è·å–EChartsåŸç”Ÿå®ä¾‹
- **è¿”å›**: `Object` - EChartså®ä¾‹å¯¹è±¡

##### `dispose()`
é”€æ¯å›¾è¡¨å®ä¾‹
- **è¿”å›**: `EChartFactory2` - æ”¯æŒé“¾å¼è°ƒç”¨

### å·¥å‚å‡½æ•°

#### `createChart(container, chartType, theme)`
åˆ›å»ºå›¾è¡¨çš„å¿«æ·å‡½æ•°
- **è¿”å›**: `EChartFactory2` - å·²åˆå§‹åŒ–çš„å›¾è¡¨å®ä¾‹

#### `updateChart(container, chartType, data, config, theme)`
å¿«é€Ÿæ›´æ–°å›¾è¡¨ï¼ˆä¼šå¤ç”¨å·²å­˜åœ¨çš„å®ä¾‹ï¼‰
- **è¿”å›**: `EChartFactory2` - å›¾è¡¨å®ä¾‹

#### `createCharts(configs)`
æ‰¹é‡åˆ›å»ºå¤šä¸ªå›¾è¡¨
- **å‚æ•°**: `configs` (Array) - å›¾è¡¨é…ç½®æ•°ç»„
- **è¿”å›**: `Array` - å›¾è¡¨å®ä¾‹æ•°ç»„

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### 1. åŸºç¡€æŸ±çŠ¶å›¾

```javascript
const data = {
  xAxis: ['äº§å“A', 'äº§å“B', 'äº§å“C', 'äº§å“D'],
  series: {
    name: 'é”€é‡',
    data: [320, 302, 301, 334],
    color: '#5470c6'
  }
};

createChart(container, 'bar', 'default').update(data);
```

### 2. å †å æŸ±çŠ¶å›¾

```javascript
const data = {
  xAxis: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”'],
  series: [
    { name: 'çº¿ä¸Š', data: [120, 132, 101, 134, 90], color: '#5470c6' },
    { name: 'çº¿ä¸‹', data: [220, 182, 191, 234, 290], color: '#91cc75' }
  ]
};

createChart(container, 'bar', 'default').update(data, { stack: 'total' });
```

### 3. é¢ç§¯æŠ˜çº¿å›¾

```javascript
const data = {
  xAxis: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ'],
  series: {
    name: 'è®¿é—®é‡',
    data: [820, 932, 901, 934, 1290],
    color: '#5470c6'
  }
};

createChart(container, 'line', 'futuristic').update(data, { areaStyle: true });
```

### 4. é¥¼å›¾

```javascript
const data = {
  series: [{
    data: [
      { value: 1048, name: 'æœç´¢å¼•æ“' },
      { value: 735, name: 'ç›´æ¥è®¿é—®' },
      { value: 580, name: 'é‚®ä»¶è¥é”€' },
      { value: 484, name: 'è”ç›Ÿå¹¿å‘Š' },
      { value: 300, name: 'è§†é¢‘å¹¿å‘Š' }
    ]
  }]
};

createChart(container, 'pie', 'minimal').update(data);
```

### 5. é›·è¾¾å›¾

```javascript
const data = {
  indicator: [
    { name: 'é”€å”®', max: 6500 },
    { name: 'ç®¡ç†', max: 16000 },
    { name: 'ä¿¡æ¯æŠ€æœ¯', max: 30000 },
    { name: 'å®¢æœ', max: 38000 },
    { name: 'ç ”å‘', max: 52000 },
    { name: 'å¸‚åœº', max: 25000 }
  ],
  series: [{
    data: [{
      value: [4300, 10000, 28000, 35000, 50000, 19000],
      name: 'é¢„ç®—åˆ†é…'
    }]
  }]
};

createChart(container, 'radar', 'default').update(data);
```

### 6. æåæ ‡å›¾

```javascript
const data = {
  angleData: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
  series: [{
    name: 'è®¿é—®é‡',
    data: [1200, 2300, 1500, 2800, 1800, 2200, 1600],
    color: '#5470c6'
  }]
};

createChart(container, 'polarBar', 'futuristic').update(data);
```

### 7. å¤šç³»åˆ—ç»„åˆ

```javascript
// åˆ›å»ºå¤šä¸ªå›¾è¡¨
const configs = [
  {
    container: document.getElementById('chart1'),
    chartType: 'bar',
    theme: 'default',
    data: barData,
    customConfig: { stack: 'total' }
  },
  {
    container: document.getElementById('chart2'),
    chartType: 'line',
    theme: 'futuristic',
    data: lineData,
    customConfig: { areaStyle: true }
  }
];

createCharts(configs);
```

## âš™ï¸ é…ç½®è¯´æ˜

### æ•°æ®æ ¼å¼

#### ç›´è§’åæ ‡ç³»å›¾è¡¨ (bar, line, scatter)

```javascript
{
  xAxis: ['åˆ†ç±»1', 'åˆ†ç±»2', 'åˆ†ç±»3'],  // Xè½´æ•°æ®
  series: {
    name: 'ç³»åˆ—åç§°',
    data: [100, 200, 150],
    color: '#5470c6'  // å¯é€‰ï¼Œè‡ªå®šä¹‰é¢œè‰²
  }
  // æˆ–å¤šç³»åˆ—
  series: [
    { name: 'ç³»åˆ—1', data: [100, 200, 150] },
    { name: 'ç³»åˆ—2', data: [200, 300, 250] }
  ]
}
```

#### é¥¼å›¾ (pie)

```javascript
{
  series: [{
    data: [
      { value: 335, name: 'ç›´æ¥è®¿é—®' },
      { value: 310, name: 'é‚®ä»¶è¥é”€' },
      { value: 234, name: 'è”ç›Ÿå¹¿å‘Š' }
    ]
  }]
}
```

#### é›·è¾¾å›¾ (radar)

```javascript
{
  indicator: [  // é›·è¾¾å›¾æŒ‡ç¤ºå™¨
    { name: 'æŒ‡æ ‡1', max: 100 },
    { name: 'æŒ‡æ ‡2', max: 100 }
  ],
  series: [{
    data: [{
      value: [80, 90],
      name: 'æ•°æ®ç³»åˆ—'
    }]
  }]
}
```

#### æåæ ‡å›¾ (polarBar, polarLine)

```javascript
{
  angleData: ['è§’åº¦1', 'è§’åº¦2', 'è§’åº¦3'],  // è§’åº¦è½´æ•°æ®
  series: [{
    name: 'ç³»åˆ—åç§°',
    data: [100, 200, 150]
  }]
}
```

### é…ç½®é€‰é¡¹

| é…ç½®é¡¹ | ç±»å‹ | è¯´æ˜ | é€‚ç”¨å›¾è¡¨ |
|--------|------|------|----------|
| `stack` | string | å †å åˆ†ç»„æ ‡è¯† | bar, line |
| `inverse` | boolean | ç¿»è½¬åæ ‡è½´ï¼ˆæ¨ªå‘æ˜¾ç¤ºï¼‰ | bar |
| `areaStyle` | boolean | å¯ç”¨é¢ç§¯å¡«å…… | line |
| `roseType` | string | ç«ç‘°å›¾ç±»å‹ | pie |
| `toolboxType` | string | å·¥å…·ç®±ç±»å‹ | æ‰€æœ‰ |

## ğŸ”¥ é«˜çº§åŠŸèƒ½

### 1. ä¸»é¢˜è‡ªå®šä¹‰

```javascript
// åˆ›å»ºè‡ªå®šä¹‰ä¸»é¢˜
const customTheme = {
  colors: {
    series: ['#FF6B6B', '#4ECDC4', '#45B7D1'],
    background: {
      chart: '#1a1a1a',
      tooltip: '#333333'
    },
    text: {
      primary: '#ffffff',
      secondary: '#cccccc'
    }
  }
};

// ä½¿ç”¨è‡ªå®šä¹‰ä¸»é¢˜
const chart = createChart(container, 'bar', customTheme);
```

### 2. é¢„è®¾é…ç½®

```javascript
// ä½¿ç”¨ä»ªè¡¨ç›˜é¢„è®¾
factory.setPreset('dashboard');

// ä½¿ç”¨åˆ†æé¢„è®¾
factory.setPreset('analysis');
```

### 3. äº‹ä»¶ç›‘å¬

```javascript
const chart = createChart(container, 'bar', 'default');
const instance = chart.getInstance();

// ç›‘å¬ç‚¹å‡»äº‹ä»¶
instance.on('click', (params) => {
  console.log('ç‚¹å‡»äº†:', params.name, params.value);
});

// ç›‘å¬å›¾ä¾‹åˆ‡æ¢
instance.on('legendselectchanged', (params) => {
  console.log('å›¾ä¾‹çŠ¶æ€:', params.selected);
});
```

### 4. åŠ¨ç”»é…ç½®

```javascript
const chart = createChart(container, 'bar', 'default');

// è‡ªå®šä¹‰åŠ¨ç”»
chart.update(data, {
  animation: true,
  animationDuration: 2000,
  animationEasing: 'elasticOut'
});
```

### 5. å“åº”å¼è®¾è®¡

```javascript
// å›¾è¡¨ä¼šè‡ªåŠ¨é€‚é…å®¹å™¨å¤§å°å˜åŒ–
// æ— éœ€æ‰‹åŠ¨è°ƒç”¨ resize()
const chart = createChart(container, 'line', 'default');

// å®¹å™¨å¤§å°æ”¹å˜æ—¶ï¼Œå›¾è¡¨ä¼šè‡ªåŠ¨è°ƒæ•´
```

### 6. ç‹¬ç«‹æ ·å¼æ¨¡å¼

```javascript
// å®Œå…¨è„±ç¦»ä¸»é¢˜ç³»ç»Ÿçš„ç‹¬ç«‹æ ·å¼
const independentOptions = factory.generateIndependentOptions(data, {
  color: ['#FF6B6B', '#4ECDC4'],
  backgroundColor: '#000000',
  grid: { left: '10%', right: '10%' }
});

factory.setCustomOptions(independentOptions);
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ‰©å±•æ–°å›¾è¡¨ç±»å‹

```javascript
// åœ¨ CHART_TYPE_CONFIGS ä¸­æ·»åŠ æ–°ç±»å‹
newChartType: {
  coordinateSystem: 'cartesian',  // åæ ‡ç³»ç±»å‹
  series: (data, theme, config) => ({
    type: 'newType',
    data: data.data,
    // å…¶ä»–é…ç½®...
  }),
  defaultConfig: {}
}
```

### æ·»åŠ æ–°ä¸»é¢˜

```javascript
// åœ¨ themes.js ä¸­æ·»åŠ æ–°ä¸»é¢˜
newTheme: {
  colors: {
    series: ['#color1', '#color2'],
    background: { chart: '#bg', tooltip: '#tooltip' },
    text: { primary: '#text1', secondary: '#text2' },
    axisLine: '#axis'
  },
  grid: { /* ç½‘æ ¼é…ç½® */ },
  components: { /* ç»„ä»¶é…ç½® */ }
}
```

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å¤„ç†å¤§æ•°æ®é‡ï¼Ÿ

A: å¯ä»¥ä½¿ç”¨ ECharts çš„æ•°æ®é‡‡æ ·å’Œè™šæ‹Ÿæ»šåŠ¨åŠŸèƒ½ï¼š

```javascript
chart.update(data, {
  dataZoom: [{
    type: 'inside',
    start: 0,
    end: 100
  }],
  sampling: 'lttb'  // é‡‡æ ·ç®—æ³•
});
```

### Q: å¦‚ä½•è‡ªå®šä¹‰æç¤ºæ¡†ï¼Ÿ

A: é€šè¿‡é…ç½® tooltip æ ¼å¼åŒ–å‡½æ•°ï¼š

```javascript
chart.update(data, {
  tooltip: {
    formatter: function(params) {
      return `${params.name}: ${params.value}`;
    }
  }
});
```

### Q: å›¾è¡¨ä¸æ˜¾ç¤ºæ€ä¹ˆåŠï¼Ÿ

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. å®¹å™¨æ˜¯å¦æœ‰æ˜ç¡®çš„å®½é«˜
2. æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®
3. å®¹å™¨æ˜¯å¦å·²æ·»åŠ åˆ°DOMä¸­
4. æ˜¯å¦æ­£ç¡®è°ƒç”¨äº† update() æ–¹æ³•

### Q: å¦‚ä½•å®ç°å›¾è¡¨è”åŠ¨ï¼Ÿ

A: é€šè¿‡äº‹ä»¶ç›‘å¬å®ç°ï¼š

```javascript
const chart1 = createChart(container1, 'bar', 'default');
const chart2 = createChart(container2, 'line', 'default');

chart1.getInstance().on('click', (params) => {
  // æ ¹æ® chart1 çš„ç‚¹å‡»æ›´æ–° chart2
  chart2.update(getRelatedData(params.dataIndex));
});
```

